<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/uploads/images/logo/favicon.ico?v=5.1.1" />






<meta name="description" content="技术之路历练">
<meta property="og:type" content="website">
<meta property="og:title" content="小小强的部落">
<meta property="og:url" content="http://xiaoxiaoqiang.win/index.html">
<meta property="og:site_name" content="小小强的部落">
<meta property="og:description" content="技术之路历练">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小小强的部落">
<meta name="twitter:description" content="技术之路历练">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://xiaoxiaoqiang.win/"/>





  <title>小小强的部落</title>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小小强的部落</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">我思故我在</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/07/10/test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/10/test/" itemprop="url">test</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-10T23:23:50+08:00">
                2017-07-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/07/08/hexo/github-pages-绑定阿里云域名/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/08/hexo/github-pages-绑定阿里云域名/" itemprop="url">github pages 绑定阿里云域名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-08T22:01:23+08:00">
                2017-07-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hexo/" itemprop="url" rel="index">
                    <span itemprop="name">hexo</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>我是小小强，这是我的第9篇原创文章，阅读需要大约6分钟。  </p>
<hr>
<h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>按照<a href="http://www.jianshu.com/p/b34db6811f45" target="_blank" rel="external">使用github pages和hexo搭建博客</a>完成博客的搭建。</p>
<h2 id="注册阿里云域名"><a href="#注册阿里云域名" class="headerlink" title="注册阿里云域名"></a>注册阿里云域名</h2><p>这个比较简单了，在<a href="https://wanwang.aliyun.com" target="_blank" rel="external">阿里云</a>申请一个域名，申请域名时需要创建一个信息模版，按要求创建模版，在申请域名时选择这个模版即可。缴费成功后，大概10分钟左右可看到域名已经通过审核。如域名为xxx.com<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/08/hexo/github-pages-绑定阿里云域名/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/07/05/LintCode/容易-167-链表求和/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/05/LintCode/容易-167-链表求和/" itemprop="url">[容易]167.链表求和</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-05T23:13:15+08:00">
                2017-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LintCode/" itemprop="url" rel="index">
                    <span itemprop="name">LintCode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我是小小强，这是我的第8篇原创文章，阅读需要大约10分钟。  </p>
<hr>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>LintCode:<a href="http://www.lintcode.com/zh-cn/problem/add-two-numbers/" target="_blank" rel="external">链表求和</a></p>
<h1 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h1><p>你有两个用链表代表的整数，其中每个节点包含一个数字。数字存储按照在原来整数中相反的顺序，使得第一个数字位于链表的开头。写出一个函数将两个整数相加，用链表形式返回和。</p>
<h1 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h1><p>给出两个链表 <code>3-&gt;1-&gt;5-&gt;null</code>和<code>5-&gt;9-&gt;2-&gt;null</code>，返回<code>8-&gt;0-&gt;8-&gt;null</code></p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>题目中要求从链表头节点开始，按位相加，同时进位。那就可以构造一个链表，存放相加结果，同时用一个临时变量存放链表相加之和，如果大于10，则设置进位标志。最后结束时判断进位标志是否为0，不为0，则需要再进位。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><ol>
<li><p>java实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * Definition for singly-linked list.</div><div class="line"> * public class ListNode &#123;</div><div class="line"> *     int val;</div><div class="line"> *     ListNode next;</div><div class="line"> *     ListNode(int x) &#123;</div><div class="line"> *         val = x;</div><div class="line"> *         next = null;      </div><div class="line"> *     &#125;</div><div class="line"> * &#125;</div><div class="line"> */</div><div class="line">public class Solution &#123;</div><div class="line">    /**</div><div class="line">     * @param l1: the first list</div><div class="line">     * @param l2: the second list</div><div class="line">     * @return: the sum list of l1 and l2 </div><div class="line">     */</div><div class="line">    public ListNode addLists(ListNode l1, ListNode l2) &#123;</div><div class="line">        // write your code here</div><div class="line">        int flag = 0;</div><div class="line">        int a = 0;</div><div class="line">        ListNode ln = new ListNode(0);</div><div class="line">        ListNode tmpln = ln, tmpl1 = l1, tmpl2 = l2, tmp = null;</div><div class="line">        if (l1 == null)&#123;</div><div class="line">            return l2;</div><div class="line">        &#125;</div><div class="line">        if (l2 == null)&#123;</div><div class="line">            return l1;</div><div class="line">        &#125;</div><div class="line">        if (l1 == null &amp;&amp; l2 == null) &#123;</div><div class="line">            return null;</div><div class="line">        &#125;</div><div class="line">        while (tmpl1 != null || tmpl2 != null)&#123;</div><div class="line">            if (tmpl1 != null)&#123;</div><div class="line">                a += tmpl1.val;</div><div class="line">            &#125;</div><div class="line">            if (tmpl2 != null)&#123;</div><div class="line">                a += tmpl2.val;</div><div class="line">            &#125;</div><div class="line">            if (flag &gt; 0) &#123;</div><div class="line">                a += flag;</div><div class="line">            &#125;</div><div class="line">            if( a&gt;=10 ) &#123;</div><div class="line">                flag = 1;</div><div class="line">                a -= 10;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">                flag = 0;</div><div class="line">            tmp = new ListNode(a);</div><div class="line">            tmpln.next = tmp;</div><div class="line">            tmpln = tmp;</div><div class="line">            tmpln.next = null;</div><div class="line">            a = 0;</div><div class="line">            if (tmpl1 != null)</div><div class="line">                tmpl1 = tmpl1.next;</div><div class="line">            if (tmpl2 != null)</div><div class="line">                tmpl2 = tmpl2.next;</div><div class="line">        &#125;</div><div class="line">        if (flag &gt; 0)&#123;</div><div class="line">            tmp = new ListNode(1);</div><div class="line">            tmpln.next = tmp;</div><div class="line">        &#125;</div><div class="line">        return ln.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>结果分析<br>结果：结果通过了LintCode的要求。<br>分析：这种实现比较好理解，但是实现起来却没什么巧妙之处。  </p>
</li>
</ol>
<h1 id="其它优化参考"><a href="#其它优化参考" class="headerlink" title="其它优化参考"></a>其它优化参考</h1><p><a href="https://discuss.leetcode.com/category/10/add-two-numbers" target="_blank" rel="external">LeetCode discuss</a></p>
<h1 id="优秀代码"><a href="#优秀代码" class="headerlink" title="优秀代码"></a>优秀代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">public class Solution &#123;</div><div class="line">    public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123;</div><div class="line">        ListNode c1 = l1;</div><div class="line">        ListNode c2 = l2;</div><div class="line">        ListNode sentinel = new ListNode(0);</div><div class="line">        ListNode d = sentinel;</div><div class="line">        int sum = 0;</div><div class="line">        while (c1 != null || c2 != null) &#123;</div><div class="line">            sum /= 10;</div><div class="line">            if (c1 != null) &#123;</div><div class="line">                sum += c1.val;</div><div class="line">                c1 = c1.next;</div><div class="line">            &#125;</div><div class="line">            if (c2 != null) &#123;</div><div class="line">                sum += c2.val;</div><div class="line">                c2 = c2.next;</div><div class="line">            &#125;</div><div class="line">            d.next = new ListNode(sum % 10);</div><div class="line">            d = d.next;</div><div class="line">        &#125;</div><div class="line">        if (sum / 10 == 1)</div><div class="line">            d.next = new ListNode(1);</div><div class="line">        return sentinel.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/07/01/LintCode/容易-569-各位相加/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/01/LintCode/容易-569-各位相加/" itemprop="url">[容易]569.各位相加</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-01T17:37:58+08:00">
                2017-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LintCode/" itemprop="url" rel="index">
                    <span itemprop="name">LintCode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我是小小强，这是我的第7篇原创文章，阅读需要大约10分钟。  </p>
<hr>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>LintCode:<a href="http://www.lintcode.com/zh-cn/problem/add-digits/" target="_blank" rel="external">各位相加</a></p>
<h1 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h1><p>给出一个非负整数 <code>num</code>，反复的将所有位上的数字相加，直到得到一个一位的整数。</p>
<h1 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h1><p>给出 <code>num = 38</code>。<br>相加的过程如下：<code>3 + 8 = 11</code>，<code>1 + 1 = 2</code>。因为 <code>2</code> 只剩下一个数字，所以返回<code>2</code>。</p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>题目要求各位相加，想当然的思路就是每次除于<code>10</code>，然后余数相加，直到无法被<code>10</code>整除，然后再把最后的余数加起来。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="递归实现"><a href="#递归实现" class="headerlink" title="递归实现"></a>递归实现</h2><ol>
<li><p>java实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public class Solution &#123;</div><div class="line">    /**</div><div class="line">     * @param num a non-negative integer</div><div class="line">     * @return one digit</div><div class="line">     */</div><div class="line">    public int addDigits(int num) &#123;</div><div class="line">        // Write your code here</div><div class="line">        int sum = 0;</div><div class="line">        while(num / 10 &gt;= 1)&#123;</div><div class="line">            sum += num % 10;</div><div class="line">            num /= 10;</div><div class="line">        &#125;</div><div class="line">        sum += num % 10;</div><div class="line">        if (sum &gt;= 10)</div><div class="line">            sum = addDigits(sum);</div><div class="line">        return sum;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>结果分析<br>结果：结果通过了LintCode的要求。<br>分析：这种实现比较好理解，但是实现起来却没什么巧妙之处。并且时间慢。  </p>
</li>
</ol>
<h1 id="其它优化参考"><a href="#其它优化参考" class="headerlink" title="其它优化参考"></a>其它优化参考</h1><p><a href="http://blog.csdn.net/tellsummer/article/details/70056256" target="_blank" rel="external">LintCode:569 各位相加</a><br><a href="https://discuss.leetcode.com/category/326/add-digits" target="_blank" rel="external">LeetCode discuss</a>  </p>
<h1 id="数学原理"><a href="#数学原理" class="headerlink" title="数学原理"></a>数学原理</h1><p><a href="https://en.wikipedia.org/wiki/Digital_root" target="_blank" rel="external">https://en.wikipedia.org/wiki/Digital_root</a><br>[Step 1]:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">438  == 40*10 +3*10 +8 ;</div><div class="line">4+3+8 == 4*(10%9)*(10%9)+3*(10%9)+8%9= 15   ;</div></pre></td></tr></table></figure></p>
<p>[Step 2]:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">15  == 1*10 + 5 ; </div><div class="line">1+5 == 1*(10%9)+5%9= 6 ;</div></pre></td></tr></table></figure></p>
<p>[So we can see]:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ab%9%9%9==ab%9; </div><div class="line">just return num%9; and don&apos;t forget num==0 or num==9</div></pre></td></tr></table></figure></p>
<h1 id="优秀代码"><a href="#优秀代码" class="headerlink" title="优秀代码"></a>优秀代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">public class Solution &#123;</div><div class="line">    public int addDigits(int num) &#123;</div><div class="line">        return num==0?0:(num%9==0?9:(num%9));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/07/01/LintCode/容易-408-二进制求和/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/01/LintCode/容易-408-二进制求和/" itemprop="url">[容易]408.二进制求和</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-01T11:36:12+08:00">
                2017-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LintCode/" itemprop="url" rel="index">
                    <span itemprop="name">LintCode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我是小小强，这是我的第6篇原创文章，阅读需要大约10分钟。  </p>
<hr>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>LintCode:<a href="http://www.lintcode.com/zh-cn/problem/add-binary/" target="_blank" rel="external">二进制求和</a></p>
<h1 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h1><p>给定两个二进制字符串，返回他们的和（用二进制表示）。</p>
<h1 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h1><p>a = 11<br>b = 1<br>返回 100  </p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>二进制相加，主要考虑进位的情况，每位在进行相加之后，要判断之前有无进位的情况，如果有，本位要进行加1处理，同时还要考虑是否要再次向高位进位。相加结果的二进制串长度是有可能超过原数的。<br>最直接的方法将二进制串转换为整数，进行相加，然后将结果再转换为二进制串。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="非递归实现"><a href="#非递归实现" class="headerlink" title="非递归实现"></a>非递归实现</h2><ol>
<li><p>java实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">public class Solution &#123;</div><div class="line">    /**</div><div class="line">     * @param a a number</div><div class="line">     * @param b a number</div><div class="line">     * @return the result</div><div class="line">     */</div><div class="line">    public String addBinary(String a, String b) &#123;</div><div class="line">        // Write your code here</div><div class="line">        if (a == null || b == null) &#123;</div><div class="line">            return null;</div><div class="line">        &#125;</div><div class="line">        return parseInt2String(parseString2(a) + parseString2(b));</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">     public static int parseString2(String str1)&#123;</div><div class="line">        char c = 0;</div><div class="line">        int sum = 0;</div><div class="line">        for (int i = 0; i &lt; str1.length(); i++) &#123;</div><div class="line">            if (str1.charAt(i) == &apos;1&apos;)&#123;</div><div class="line">                sum += 1&lt;&lt;(str1.length()-1-i);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return sum;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static String parseInt2String(int a)&#123;</div><div class="line">        String str = &quot;&quot;;</div><div class="line">        if (a == 0)</div><div class="line">            return &quot;0&quot;;</div><div class="line">        while (a != 0)&#123;</div><div class="line">            str += a % 2;</div><div class="line">            a = a/2;</div><div class="line">        &#125;</div><div class="line">        String str2 = &quot;&quot;;</div><div class="line">        int i = str.length();</div><div class="line">        while (i &gt; 0 )&#123;</div><div class="line">            str2+=str.charAt(i-1);</div><div class="line">            i--;</div><div class="line">        &#125;</div><div class="line">        return str2;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>结果分析<br>结果：结果通过了LintCode的要求。<br>分析：这种实现比较好理解，但是实现起来却没什么巧妙之处。</p>
</li>
</ol>
<h1 id="其它优化参考"><a href="#其它优化参考" class="headerlink" title="其它优化参考"></a>其它优化参考</h1><p><a href="http://blog.csdn.net/cjt5047/article/details/50708902" target="_blank" rel="external">lintcode 二进制求和 给定两个二进制字符串，返回他们的和</a><br><a href="http://blog.csdn.net/sunny_ran/article/details/49054183" target="_blank" rel="external">LIntCode-二进制求和</a><br><a href="https://discuss.leetcode.com/topic/13698/short-ac-solution-in-java-with-explanation" target="_blank" rel="external">Short AC solution in Java with explanation</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/06/29/LintCode/入门-366-斐波纳契数列/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/29/LintCode/入门-366-斐波纳契数列/" itemprop="url">[入门]366.斐波纳契数列</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-29T22:16:06+08:00">
                2017-06-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LintCode/" itemprop="url" rel="index">
                    <span itemprop="name">LintCode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我是小小强，这是我的第4篇原创文章，阅读需要大约10分钟。  </p>
<hr>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>LintCode:<a href="http://www.lintcode.com/zh-cn/problem/fibonacci/" target="_blank" rel="external">斐波纳契数列</a></p>
<h1 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h1><p>查找<code>斐波纳契数列</code>中第 N 个数。<br>所谓的<code>斐波纳契数列</code>是指：<br>前2个数是 <code>0</code> 和<code>1</code> 。<br>第 i 个数是第<code>i-1</code>个数和第<code>i-2</code> 个数的和。<br>斐波纳契数列的前10个数字是：<br><code>0, 1, 1, 2, 3, 5, 8, 13, 21, 34 ...</code>  </p>
<h1 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h1><p>给定 <code>1</code>，返回<code>0</code><br>给定 <code>2</code>，返回<code>1</code><br>给定<code>10</code>，返回 <code>34</code></p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="递归实现"><a href="#递归实现" class="headerlink" title="递归实现"></a>递归实现</h2><ol>
<li><p>java代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">class Solution &#123;</div><div class="line">    public int fibonacci(int n) &#123;</div><div class="line">        if (n == 1) &#123;</div><div class="line">            return 0;</div><div class="line">        &#125; else if (n == 2) &#123;</div><div class="line">            return 1;</div><div class="line">        &#125; else &#123;</div><div class="line">            return fibonacci(n - 1) + fibonacci(n - 2);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>结果分析<br>结果：结果不尽人意，速度非常慢，甚至没有通过 LintCode 的评测。<br>分析：这种递归不同于一般的递归，在n较大时，两次递归调用中存在大量的重复运算，导致速度非常慢。</p>
</li>
</ol>
<h2 id="非递归实现"><a href="#非递归实现" class="headerlink" title="非递归实现"></a>非递归实现</h2><ol>
<li><p>java代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">class Solution &#123;</div><div class="line">    public int fibonacci(int n) &#123;</div><div class="line">        if(1==n)</div><div class="line">            return 0;</div><div class="line">        if(2==n)</div><div class="line">            return 1;</div><div class="line">        int a=0;</div><div class="line">        int b=1;</div><div class="line">        int sum=0;</div><div class="line">        while(n&gt;2)</div><div class="line">        &#123;</div><div class="line">            sum=a+b;</div><div class="line">            a=b;</div><div class="line">            b=sum;</div><div class="line">            n--;</div><div class="line">        &#125;</div><div class="line">        return sum;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>结果分析<br>结果：经测试 C++ 最快可以以 10ms 轻松通过 LintCode 的评测。<br>分析：时间复杂度为 o(n) ，空间复杂度为 o(1) ，效果不错。<br>细节：使用 while 代替 for 节省了一个 Int(4Byte) 的空间。  </p>
</li>
</ol>
<h1 id="其它优化参考"><a href="#其它优化参考" class="headerlink" title="其它优化参考"></a>其它优化参考</h1><p><a href="http://www.jianshu.com/p/be66df126569" target="_blank" rel="external">斐波纳契数列实现及优化</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/06/29/LintCode/容易-1-A-B问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/29/LintCode/容易-1-A-B问题/" itemprop="url">[容易]1.A+B问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-29T21:51:07+08:00">
                2017-06-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LintCode/" itemprop="url" rel="index">
                    <span itemprop="name">LintCode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我是小小强，这是我的第5篇原创文章，阅读需要大约10分钟。  </p>
<hr>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>LintCode:<a href="http://www.lintcode.com/zh-cn/problem/a-b-problem/" target="_blank" rel="external">A+B问题</a></p>
<h1 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h1><p>给出两个整数<code>a</code>和<code>b</code>, 求他们的和, 但不能使用<code>+</code> 等数学运算符。</p>
<ul>
<li>说明<br>a和b都是 32位 整数么？<br>是的<br>我可以使用位运算符么？<br>当然可以  </li>
</ul>
<h1 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h1><p>如果<code>a=1</code>并且<code>b=2</code>，返回<code>3</code></p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>题目要求不可以使用加减乘除四则运算，那肯定是在移位或者位运算上做文章。经过分析，两个整数<code>a</code>和<code>b</code>的加法操作，可以等效于<code>(a&amp;b)&lt;&lt;1</code>和<code>a^b</code>相加，也就是进位值和非进位值，然后又可以继续通过这种操作进行运算，直到达到一个不满足的条件（也就是不在进位）为止。这就可以借助循环或者递归操作，关键在于找到结束循环和递归的条件。对于<code>a&amp;b</code>来说，显然是有可能不在进位，也就是值为0的，这就是一个有效的判断条件。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="递归实现"><a href="#递归实现" class="headerlink" title="递归实现"></a>递归实现</h2><ol>
<li><p>java代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">class Solution &#123;</div><div class="line">    /*</div><div class="line">     * param a: The first integer</div><div class="line">     * param b: The second integer</div><div class="line">     * return: The sum of a and b</div><div class="line">     */</div><div class="line">    public int aplusb(int a, int b) &#123;</div><div class="line">        // write your code here, try to do it without arithmetic operators.</div><div class="line">        </div><div class="line">        if(a == 0)</div><div class="line">            return b;</div><div class="line">        return aplusb((a&amp;b)&lt;&lt;1, a ^ b);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>结果分析<br>结果：结果通过了LintCode的要求。<br>分析：这种递归只是单纯两个整数的操作，在若干次递归运算之后，很快达到某个操作数为0的条件，从而结束递归。因此速度还是可以达到要求。</p>
</li>
</ol>
<h2 id="非递归实现"><a href="#非递归实现" class="headerlink" title="非递归实现"></a>非递归实现</h2><ol>
<li>java代码<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">class Solution &#123;</div><div class="line">    /*</div><div class="line">     * param a: The first integer</div><div class="line">     * param b: The second integer</div><div class="line">     * return: The sum of a and b</div><div class="line">     */</div><div class="line">    public int aplusb(int a, int b) &#123;</div><div class="line">        // write your code here, try to do it without arithmetic operators.</div><div class="line">        </div><div class="line">        int sum = 0;</div><div class="line">        do &#123;</div><div class="line">            sum = a ^ b;</div><div class="line">            a = (a &amp; b) &lt;&lt; 1;</div><div class="line">            b = sum;</div><div class="line">        &#125; while ( a != 0 );</div><div class="line">        </div><div class="line">        return sum;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>2.结果分析<br>结果：结果通过了LintCode的要求。<br>分析：这种操作需要完全理解实现原理。<strong>加法</strong>，可以拆分成<strong>异或得到的“加法不进位”</strong>与<strong>相与左移1的进位</strong>的<strong>加法</strong>，因此，每次递归中都进行异或、相与左移1，然后，将得到的结果再做同样的操作，直到进位为0，递归停止。</p>
<h1 id="其它优化参考"><a href="#其它优化参考" class="headerlink" title="其它优化参考"></a>其它优化参考</h1><p><a href="http://blog.csdn.net/cjt5047/article/details/50686724" target="_blank" rel="external">lintcode刷题 A + B 问题 位运算</a></p>
<blockquote>
<p>思路：<br>考虑一个普通的加法计算：5＋17＝22<br>在十进制加法中可以分为如下3步进行：<br>    忽略进位，只做对应各位数字相加，得到12（个位上5＋7＝12，忽略进位，结果2）；<br>    记录进位，上一步计算中只有个位数字相加有进位1，进位值为10；<br>    按照第1步中的方法将进位值与第1步结果相加，得到最终结果22。<br>下面考虑二进制数的情况（5＝101，17＝10001）：<br>仍然分3步：<br>    忽略进位，对应各位数字相加，得到10100；<br>   记录进位，本例中只有最后一位相加时产生进位1，进位值为10（二进制）；<br>     按照第1步中的方法将进位值与第1步结果相加，得到最终结果10110，正好是十进制数22的二进制表示。<br>接下来把上述二进制加法3步计算法用位运算替换：<br>    第1步（忽略进位）：0＋0＝0，0＋1＝1，1＋0＝0，1＋1＝0，典型的异或运算。<br>    第2步：很明显，只有1＋1会向前产生进位1，相对于这一数位的进位值为10，而10＝(1&amp;1)&lt;&lt;1。<br>    第3步：将第1步和第2步得到的结果相加，其实又是在重复这2步，直到不再产生进位为止。  </p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/06/29/hexo/使用github-pages和hexo搭建博客/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/29/hexo/使用github-pages和hexo搭建博客/" itemprop="url">使用github-pages和hexo搭建博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-29T21:51:07+08:00">
                2017-06-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hexo/" itemprop="url" rel="index">
                    <span itemprop="name">hexo</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我是小小强，这是我的第4篇原创文章，阅读需要大约10分钟。  </p>
<hr>
<p><strong>三思而行</strong>:在真正操作前，学习了网上的资料，逐步明确搭建博客的目的。</p>
<ul>
<li>使用github pages 及hexo完成博客</li>
<li>分别备份博客源文件及生成的静态页面，前者的仓库应当是私有的</li>
<li>可免密推送仓库</li>
</ul>
<h3 id="安装及配置github-sshkey"><a href="#安装及配置github-sshkey" class="headerlink" title="安装及配置github sshkey"></a>安装及配置github sshkey</h3><p><strong>前提</strong>:本地具备git环境</p>
<ul>
<li>注册github并创建仓库<br>创建xx.github.io.git仓库(xx为github的昵称)，设置master为默认分支，同时本地执行：<blockquote>
<p>cd .ssh<br>ssh-keygen -t rsa -C “xxx@163.com”</p>
</blockquote>
</li>
</ul>
<p>复制产生的id_rsa.pub内容到github上，执行如下命令测试是否成功：</p>
<blockquote>
<p>ssh -T git@github.com</p>
</blockquote>
<ul>
<li>配置多用户登录<br>后续会有多个帐号的sshkey切换，因此在.ssh目录创建config文件，输入：<blockquote>
<p>#github<br>Host github<br>  HostName github.com<br>  User git<br>  IdentityFile ~/.ssh/id_rsa  </p>
</blockquote>
</li>
</ul>
<p>如果无错误发生，则本机可免密提交代码到github上。为方便提交代码，完善git信息</p>
<blockquote>
<p>git config –global user.name “aierui”//用户名<br>git config –global user.email  “imland@outlook.com”//填写自己的邮箱    </p>
</blockquote>
<ul>
<li>检出仓库到本地<blockquote>
<p>git clone <a href="https://github.com/xx/xx.github.io.git" target="_blank" rel="external">https://github.com/xx/xx.github.io.git</a>   </p>
</blockquote>
</li>
</ul>
<p>注意：在github上版本库名称需要为xx.github.io的名称，克隆到本地时任意名称均可。</p>
<h3 id="安装及配置hexo"><a href="#安装及配置hexo" class="headerlink" title="安装及配置hexo"></a>安装及配置hexo</h3><ul>
<li><p>安装nodejs</p>
<blockquote>
<p>brew install node  </p>
</blockquote>
<p>安装成功后，可以使用npm指令，可以使用node -v查看信息。</p>
</li>
<li><p>配置hexo</p>
<blockquote>
<p>npm install -g hexo-cli  安装hexo<br>cd xx.github.io.git<br>hexo init 初始化(这一步会覆盖掉.git目录)<br>npm install 安装依赖组件<br>npm install hexo-deployer-git –save  </p>
</blockquote>
</li>
</ul>
<p>安装完成后，执行hexo clean;hexo -g;hexo －s可以在localhost:4000查看hexo的默认页面。</p>
<ul>
<li><p>安装next主题</p>
<blockquote>
<p>git clone <a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external">https://github.com/iissnan/hexo-theme-next</a> themes/next<br>cd themes/next<br>git pull   </p>
</blockquote>
<p>  配置xx.github.io.git目录下的_config.yml</p>
<blockquote>
<p> language: zh-Hans #网站语言<br> timezone: Asia/Shanghai #时区<br> theme: next<br> deploy:<br> type: git<br> repository: <a href="https://github.com/xx/xx.github.io.git" target="_blank" rel="external">https://github.com/xx/xx.github.io.git</a><br> branch: master    </p>
</blockquote>
<p>配置上面的地址后，每次执行hexo -g;hexo -d会将生成的静态页面推送到github上的xx.github.io.git仓库。</p>
</li>
</ul>
<h3 id="安装及配置oschina"><a href="#安装及配置oschina" class="headerlink" title="安装及配置oschina"></a>安装及配置oschina</h3><ul>
<li>设置oschina<br>在oschina上创建仓库hexo，并为oschina添加sshkey<blockquote>
<p>ssh-keygen -t rsa -C “xx@163.com” -f oschina</p>
</blockquote>
</li>
</ul>
<p>将oschina.pub拷贝到oschina的用户设定下。同时修改.ssh/config文件，加入：</p>
<blockquote>
<p>#osOne<br>Host oschina<br>    HostName git.oschina.net<br>    User git<br>    IdentityFile ~/.ssh/oschina  </p>
</blockquote>
<p>执行ssh -T git@git.oschina.net测试是否成功 。</p>
<ul>
<li>配置本地xx.github.io.git映射到hexo<blockquote>
<p>cd xx.github.io.git<br> rm -rf .git<br> rm -rf themes/next/.git(原因下面解释)<br>git init<br>git remote add origin <a href="https://git.oschina.net/xx/hexo.git" target="_blank" rel="external">https://git.oschina.net/xx/hexo.git</a><br>git pull origin master<br>git add .<br>git commit -m “add repo first”<br>git push origin master    </p>
</blockquote>
</li>
</ul>
<p>编辑 .gitignore，加入</p>
<blockquote>
<p>/.deploy_git<br>/public</p>
</blockquote>
<p>按照上面的配置完成后，本地源文件会推送到oschina的hexo.git，执行hexo d之后的静态文件会推送到github的xx.github.io.git的master分支。</p>
<h3 id="日常使用"><a href="#日常使用" class="headerlink" title="日常使用"></a>日常使用</h3><h4 id="编辑博客文章"><a href="#编辑博客文章" class="headerlink" title="编辑博客文章"></a>编辑博客文章</h4><p>方法一：对于强迫症患者，希望将文章按照分类categories存放在不同的目录，那么就可以在_posts目录下手动建立文件夹。  </p>
<ul>
<li>在_posts下创建dir目录，用于存放某一categories的文章  </li>
<li>执行hexo new “file”会在_posts目录下产生file.md文件，将文件拷贝到dir目录  </li>
<li>编辑file.md文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: &apos;title&apos;</div><div class="line">date: 2017-06-29 21:51:07</div><div class="line">categories: dir ＃为手动创建的目录名</div><div class="line">tags: [tags1,tags2]</div><div class="line">---</div></pre></td></tr></table></figure>
</li>
</ul>
<p>方法二：对于非强迫症患者，实际没有必要创建dir目录，只要在file.md中像上文一样指明categories就行。这个时候创建的文章在默认路径下就可以，只要不嫌乱。</p>
<h4 id="提交管理"><a href="#提交管理" class="headerlink" title="提交管理"></a>提交管理</h4><p>在本地对博客进行修改（添加新博文、修改样式等等）后，通过下面的流程进行管理：</p>
<ul>
<li>依次执行git add .、git commit -m “…”、git push指令将改动的源文件推送到oschina</li>
<li>执行hexo clean;hexo g -d发布网站到github的master分支   </li>
</ul>
<h3 id="恢复资料"><a href="#恢复资料" class="headerlink" title="恢复资料"></a>恢复资料</h3><p>如果想在一个新环境使用博客，按照以下流程处理：</p>
<ul>
<li>使用git clone <a href="https://git.oschina.net/wayd2001/hexo.git" target="_blank" rel="external">https://git.oschina.net/wayd2001/hexo.git</a> 拷贝仓库</li>
<li>在hexo.git目录执行npm install -g hexo-cli、npm install、npm install hexo-deployer-git<br><strong>注意</strong>一定不要执行hexo init。</li>
</ul>
<h3 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h3><ul>
<li>执行hexo -d提示“error:deploy not found:git”，执行下面命令即可<blockquote>
<p>npm install hexo-deployer-git –save</p>
</blockquote>
</li>
<li>执行ssh -T git@git.oschina.net提示Permission denied (publickey)，是因为产生的sshkey未添加到系统生效，执行如下命令:<blockquote>
<p>ssh-add ~/.ssh/私钥名  </p>
</blockquote>
</li>
<li>如果不介意博客源文件也放在github上的话，可以先把xx.github.io.git库下到本地，然后在本地建立一个hexo分支，然后把本地的hexo分支推送到github，同时github设置hexo为默认分支。源文件推送到hexo分支，在执行hexo -d时，生成的静态文件会推送到master分支。这样就不需要oschina私有库。使用github一个库，两个分支一样达到目的。</li>
<li><p>hexo在本地测试运行重启后页面一直空白，或者参照”恢复资料”一节部署后提示如下：</p>
<blockquote>
<p>WARN  No layout: 2017/05/13/hello-world/index.html<br>WARN  No layout: archives/index.html<br>WARN  No layout: archives/2017/index.html<br>WARN  No layout: archives/2017/05/index.html<br>WARN  No layout: index.html    </p>
</blockquote>
<p>这个原因是从oschina下载的themes目录下的next主题目录为空，因为next也是一个版本库，目录下包含.git目录，当向oschina进行push时，未push上去。目前的解决方案时将next目录下的.git改名为next_git，在此push发现还是没有提交上去。然后将next目录拷贝到库之外的目录，执行push在服务端先删除next，然后再把next拷贝回来，再次push。</p>
</li>
<li><p>fatal: The current branch master has no upstream branch.</p>
<blockquote>
<p>git push -u origin master(不要-u也可以)<br>或者<br>git add -A<br>git commit<br>git push origin master    </p>
</blockquote>
</li>
</ul>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><blockquote>
<p>hexo help #查看帮助<br>hexo init #初始化一个目录<br>hexo new “postName” #新建文章<br>hexo new page “pageName” #新建页面<br>hexo generate #生成网页，可以在 public 目录查看整个网站的文件<br>hexo server #本地预览，’Ctrl+C’关闭<br>hexo deploy #部署.deploy目录<br>hexo clean #清除缓存，<strong>强烈建议每次执行命令前先清理缓存，每次部署前先删除 .deploy 文件夹</strong><br>npm install hexo -g #安装<br>npm update hexo -g #升级<br>hexo generate –deploy<br>hexo deploy –generate<br>hexo deploy -g<br>hexo server -g<br>hexo new draft <title>  新建草稿<br>hexo publish draft <title> 发布草稿为post</title></title></p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.jianshu.com/p/973e718e3096" target="_blank" rel="external">记录网站诞生过程-使用hexo+github pages</a><br><a href="http://www.jianshu.com/p/a791c0e00544" target="_blank" rel="external">Github-Pages-Hexo搭建博客</a><br><a href="https://www.zhihu.com/question/21193762" target="_blank" rel="external">使用hexo，如果换了电脑怎么更新博客？</a><br><a href="http://wp.huangshiyang.com/hexo常见问题解决方案" target="_blank" rel="external">Hexo常见问题解决方案</a><br><a href="http://www.jianshu.com/p/35e197cb1273" target="_blank" rel="external">Hexo搭建Github-Pages博客填坑教程</a><br><a href="http://ibruce.info/2013/11/22/hexo-your-blog/" target="_blank" rel="external">hexo你的博客</a><br><a href="http://www.jianshu.com/p/637fb282f71a" target="_blank" rel="external">GitHubPages + Hexo—详解博客搭建</a><br><a href="http://cherryblog.site" target="_blank" rel="external">Cherry’s博客</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/05/14/网络编程/网络编程中send和recv常见错误梳理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/14/网络编程/网络编程中send和recv常见错误梳理/" itemprop="url">网络编程中send和recv常见错误梳理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-14T22:04:27+08:00">
                2017-05-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网络编程/" itemprop="url" rel="index">
                    <span itemprop="name">网络编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>网络开发时，调用send和recv进行数据收发，经常会遇到一些异常问题，导致返回值为－1，errno被置为某个特殊值。这时就需要我们根据经验，结合实际情况判断问题症结，这样才能快速定位和处理问题。下面总结了一些开发中，经常会遇到的问题。</p>
<ul>
<li><p><strong>Connection reset by peer</strong><br>这个错误一般是对端已经关闭连接（处于关闭连接过程中），本端依然向对端发送数据导致。</p>
</li>
<li><p><strong>Broken pipe</strong><br>这个错误一般是向一个已经关闭的套接字中写数据，导致管道错误。默认操作系统会终止进程，在c程序中需要将该信号忽略。<br>当向一个已经关闭的链接发送数据时，由于处于tcp的状态不同，可能会导致上面两种不同的结果。</p>
</li>
<li><p><strong>errno为EAGAIN EWOULDBLOCK EINTR</strong><br>这个是程序中当send和recv返回－1时，判断errno如果为上述值，需要再次send和recv。有下面几个情况：</p>
<ol>
<li>用于非阻塞套接字</li>
<li>阻塞套接字，但是设置了SO_RCVTIMEO和SO_SNDTIMEO</li>
<li>O_NODELAY会导致write接口返回EAGAIN。如果设置了O_NODELAY而当前不可写，那么write接口会设置errno为EAGAIN，但是write接口会返回0而不是-1。</li>
</ol>
</li>
<li><p><strong>recv返回0 </strong><br>这个是对端已经正常关闭套接字，本端获取这个返回值时，也应当正常关闭。如果对端调用close关闭套接字，本端的recv会从阻塞状态（如果处于阻塞的话）立即返回0。</p>
</li>
<li><p><strong>send和recv一直阻塞</strong><br>用于非阻塞套接字，且未设置超时时间。有以下情况：</p>
<ol>
<li>发送方阻塞：内核发送缓冲区已满，无法将数据从用户空间拷贝到内核空间，一般对端未及时读取数据导致。</li>
<li>接收方阻塞：发送方未发送数据导致内核接收缓冲区为空或者应用未及时取走数据。<br>在阻塞状态下，如果断开网络连接，有可能一直阻塞下去。</li>
</ol>
</li>
<li><p><strong>双方同时send导致死锁问题</strong><br>参考<a href="http://m.blog.csdn.net/article/details?id=64131277" target="_blank" rel="external">http://m.blog.csdn.net/article/details?id=64131277</a></p>
</li>
</ul>
<h3 id="另外在java中，会有一些异常，从网上摘录如下"><a href="#另外在java中，会有一些异常，从网上摘录如下" class="headerlink" title="另外在java中，会有一些异常，从网上摘录如下"></a>另外在java中，会有一些异常，从网上摘录如下</h3><blockquote>
<p>Connection reset by peer的常见原因：<br>1）服务器的并发连接数超过了其承载量，服务器会将其中一些连接关闭；<br>   如果知道实际连接服务器的并发客户数没有超过服务器的承载量，则有可能是中了病毒或者木马，引起网络流量异常。可以使用netstat -an查看网络连接情况。<br>2）客户关掉了浏览器，而服务器还在给客户端发送数据；<br>3）浏览器端按了Stop；<br>   这两种情况一般不会影响服务器。但是如果对异常信息没有特别处理，有可能在服务器的日志文件中，重复出现该异常，造成服务器日志文件过大，影响服务器的运行。可以对引起异常的部分，使用try…catch捕获该异常，然后不输出或者只输出一句提示信息，避免使用e.printStackTrace();输出全部异常信息。<br>4）防火墙的问题；<br>   如果网络连接通过防火墙，而防火墙一般都会有超时的机制，在网络连接长时间不传输数据时，会关闭这个TCP的会话，关闭后在读写，就会导致异常。 如果关闭防火墙，解决了问题，需要重新配置防火墙，或者自己编写程序实现TCP的长连接。实现TCP的长连接，需要自己定义心跳协议，每隔一段时间，发送一次心跳协议，双方维持连接。<br>5）JSP的buffer问题。<br>   JSP页面缺省缓存为8k，当JSP页面数据比较大的时候，有可能JSP没有完全传递给浏览器。这时可以适当调整buffer的大小。 &lt;%@ page buffer=”100k”%&gt;</p>
</blockquote>
<h3 id="其它异常"><a href="#其它异常" class="headerlink" title="其它异常"></a>其它异常</h3><blockquote>
<p>第1个异常是java.Net.BindException:Address already in use: JVM_Bind。该异常发生在服务器端进行new ServerSocket(port)（port是一个0，65536的整型值）操作时。异常的原因是以为与port一样的一个端口已经被启动，并进行监听。此时用netstat –an命令，可以看到一个Listending状态的端口。只需要找一个没有被占用的端口就能解决这个问题。</p>
<p>第2个异常是java.net.ConnectException: Connection refused: connect。该异常发生在客户端进行 new Socket(ip, port)操作时，该异常发生的原因是或者具有ip地址的机器不能找到（也就是说从当前机器不存在到指定ip路由），或者是该ip存在，但找不到指定的端口进行监听。出现该问题，首先检查客户端的ip和port是否写错了，如果正确则从客户端ping一下服务器看是否能 ping通，如果能ping通（服务服务器端把ping禁掉则需要另外的办法），则看在服务器端的监听指定端口的程序是否启动，这个肯定能解决这个问题。 </p>
<p>第3个异常是java.net.SocketException: Socket is closed，该异常在客户端和服务器均可能发生。异常的原因是己方主动关闭了连接后（调用了Socket的close方法）再对网络连接进行读写操作。 </p>
<p>第4个异常是java.net.SocketException: （Connection reset或者 Connect reset by peer:Socket write error）。该异常在客户端和服务器端均有可能发生，引起该异常的原因有两个，第一个就是如果一端的Socket被关闭（或主动关闭或者因为异常退出而引起的关闭），另一端仍发送数据，发送的第一个数据包引发该异常 (Connect reset by peer)。另一个是一端退出，但退出时并未关闭该连接，另一端如果在从连接中读数据则抛出该异常（Connection reset）。简单的说就是在连接断开后的读和写操作引起的。 </p>
<p>第5个异常是java.net.SocketException: Broken pipe。该异常在客户端和服务器均有可能发生。在第4个异常的第一种情况中（也就是抛出SocketExcepton:Connect reset by peer:Socket write error后），如果再继续写数据则抛出该异常。前两个异常的解决方法是首先确保程序退出前关闭所有的网络连接，其次是要检测对方的关闭连接操作，发现对方关闭连接后自己也要关闭该连接。</p>
<p>客户端错误代码10053 Software caused connection abort（软件原因导致连接中断）</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoqiang.win/2017/05/14/网络编程/从tcp原理角度理解Broken-pipe和Connection-reset-by-peer的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小小强">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/logo/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小强的部落">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/14/网络编程/从tcp原理角度理解Broken-pipe和Connection-reset-by-peer的区别/" itemprop="url">从tcp原理角度理解Broken pipe和Connection reset by peer的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-14T22:02:05+08:00">
                2017-05-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网络编程/" itemprop="url" rel="index">
                    <span itemprop="name">网络编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原文链接："><a href="#原文链接：" class="headerlink" title="原文链接："></a>原文链接：</h2><p><a href="http://lovestblog.cn/blog/2014/05/20/tcp-broken-pipe/" target="_blank" rel="external">http://lovestblog.cn/blog/2014/05/20/tcp-broken-pipe/</a></p>
<p>以前我们经常会碰到Broken pipe或者Connection reset by peer之类的异常，但是tcp实现里什么情况下会抛出这些异常呢，以前我给对方的回答都是模棱两可的，自己说实话都没把握，因为自己也没有验证过，对它们的认识都是从网上看来的，正确与否也不知道，昨天独明突然又问到这个问题，前段时间正好对tcp这块研究了一段时间，有了点理论知识之后再从实践角度对此问题进行一下分析，下面对我这次的调研过程进行下描述与大家分享，希望大家以后对此类问题都能很自信地应答。</p>
<h2 id="三次握手和四次挥手过程"><a href="#三次握手和四次挥手过程" class="headerlink" title="三次握手和四次挥手过程"></a>三次握手和四次挥手过程</h2><p>  在讲具体的原因之前，我们有必要补充下tcp这块的一些基础知识，我们都知道tcp通信有三次握手和四次挥手，网上介绍的文章也一大堆，图我也懒得画了，直接网上找一个图给大家</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2492650-99fe64ffbd9455f8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tcp_hank.jpg"></p>
<p>三次握手是最前面的三条线表示的过程，四次挥手是最后面的四条线表示的过程，里面涉及到几个关键词，SYN，ACK，FIN，MSS，其中SYN是主要用在三次握手过程中的，FIN用在四次挥手过程中，ACK在三次握手和四次挥手过程中的作用就是对收到的SYN和FIN做一个确认，SYN，FIN等存在于TCP头里(tcp报文图也给大家弄了个图，不用再去找啦)，0/1表示有无此标记，在tcp实现里后面还会跟一个依次递增的数字，比如上面的J，K等，确认就是递增这些数字(真正的数据报文的ack除外)，MSS是表示每一个tcp报文里数据字段的最大长度，不包括tcp头的大小噢 相信大家看到这两个图会对这些概念有了一个清晰的认识了</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2492650-e5655db8bce6f4ec.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tcp_header.jpg"></p>
<h2 id="tcpdump抓包工具"><a href="#tcpdump抓包工具" class="headerlink" title="tcpdump抓包工具"></a>tcpdump抓包工具</h2><p>  介绍了基础原理之后，再介绍下抓包工具，tcpdump，这工具对你了解tcp的整个过程会非常有帮助，在你无法调试tcp实现的情况下这个工具自然也是必不可少的，具体用法网上有很多介绍，直接从man page上也可以看到详细的介绍，我也不多说啦，下面的截图就是tcpdump根据tcp通信过程获取到的<br><img src="http://upload-images.jianshu.io/upload_images/2492650-e10a17f20cea71d8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tcpdump_1.jpg"></p>
<p>这要稍微提下tcpdump的结果和上面的几个过程的对应关系 前面三条其实就是我们上面所说的三次握手，四次握手过程上面没有完全表现出来，只完成了一半的挥手过程（5，8两条表示的） 里面有几个标识S，F，ack，P，其实还有个R，如果有这些标识那么在tcp头里的SYN，FIN，ACK，PSH，RET分别为1，其中PSH表示要求tcp立即将数据传递给上层，不要做别的什么处理，RET这个表示重置连接，也是和我们今天讨论的问题有很大关系的FLAG，下面会详细介绍</p>
<h2 id="reset报文发送场景"><a href="#reset报文发送场景" class="headerlink" title="reset报文发送场景"></a>reset报文发送场景</h2><p>  RST的标志位，这个标识为在如下几种情况下会被设置，以下是我了解的情况，可能还有更多的场景，没有验证</p>
<ul>
<li>当尝试和未开放的服务器端口建立tcp连接时，服务器tcp将会直接向客户端发送reset报文</li>
<li>双方之前已经正常建立了通信通道，也可能进行过了交互，当某一方在交互的过程中发生了异常，如崩溃等，异常的一方会向对端发送reset报文，通知对方将连接关闭</li>
<li>当收到TCP报文，但是发现该报文不是已建立的TCP连接列表可处理的，则其直接向对端发送reset报文</li>
<li>ack报文丢失，并且超出一定的重传次数或时间后，会主动向对端发送reset报文释放该TCP连接<h2 id="Broken-pipe以及Connection-reset-by-peer"><a href="#Broken-pipe以及Connection-reset-by-peer" class="headerlink" title="Broken pipe以及Connection reset by peer"></a>Broken pipe以及Connection reset by peer</h2>  做了这么些铺垫之后下面进入正题，那么Broken pipe或者Connection reset by peer分别代表什么意思呢，下面从glibc的源码里有对此的介绍<blockquote>
<p>TRANS Broken pipe; there is no process reading from the other end of a pipe.<br>TRANS Every library function that returns this error code also generates a<br>TRANS @code{SIGPIPE} signal; this signal terminates the program if not handled<br>TRANS or blocked.  Thus, your program will never actually see @code{EPIPE}<br>TRANS unless it has handled or blocked @code{SIGPIPE}.<br>sysdeps/generic/siglist.h:39 sysdeps/gnu/errlist.c:359<br>sysdeps/unix/siglist.c:39<br>msgid “Broken pipe”<br>msgstr “断开的管道”<br>TRANS A network connection was closed for reasons outside the control of the<br>TRANS local host, such as by the remote machine rebooting or an unrecoverable<br>TRANS protocol violation.<br>sysdeps/gnu/errlist.c:614<br>msgid “Connection reset by peer”<br>msgstr “”</p>
</blockquote>
</li>
</ul>
<p>其实我们java异常里看到的Broken pipe或者Connection reset by peer信息不是jdk或者jvm里定义的，我看到这些关键字往往会首先搜索下jdk或者hotspot源码找到位置进行上下文分析，但是这次没找到，后面才想到应该是linux或者glibc里定义的，果然在glibc离看到了如上的描述和定义<br>  对于Broken pipe在管道的另外一端没有进程再读的时候就会抛出此异常，Connection reset by peer的描述其实不是很正确，从我的实践来看只描述了一方面，其实在某一端正常close之后，也是可能会有此异常的。</p>
<h2 id="异常模拟"><a href="#异常模拟" class="headerlink" title="异常模拟"></a>异常模拟</h2><p>  从我的测试场景是这样的， 共同的前提是客户端向服务端发了数据之后立马调用close关闭socket并进程退出，而服务端在收到客户端的数据之后sleep一会，保证对方的socket已经关闭，接着分别进行两种场景测试</p>
<h3 id="场景："><a href="#场景：" class="headerlink" title="场景："></a>场景：</h3><p>服务端往socket里写一次数据，返回继续做select<br>服务端连续写两次数据，必须保证两次的buffer都是有数据的，也就是保证ByteBuffer的pos和limit要不是一个值</p>
<h3 id="结果："><a href="#结果：" class="headerlink" title="结果："></a>结果：</h3><ol>
<li><p>会抛出Connection reset by peer<br><img src="http://upload-images.jianshu.io/upload_images/2492650-eb00c345ec6e795f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tcp_error_1.jpg"></p>
</li>
<li><p>会抛出Broken pipe<br><img src="http://upload-images.jianshu.io/upload_images/2492650-52b13448f9a3085e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tcp_error_2.jpg"></p>
<h3 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h3><p>当我们往一个对端已经close的通道写数据的时候，对方的tcp会收到这个报文，并且反馈一个reset报文，tcpdump的结果如下所示,当收到reset报文的时候，继续做select读数据的时候就会抛出Connect reset by peer的异常，从堆栈可以看得出</p>
</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/2492650-f4de7f7664e33082.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tcpdump_2.jpg"></p>
<p>当第一次往一个对端已经close的通道写数据的时候会和上面的情况一样，会收到reset报文，当再次往这个socket写数据的时候，就会抛出Broken pipe了 ，根据tcp的约定，当收到reset包的时候，上层必须要做出处理，调用将socket文件描述符进行关闭，其实也意味着pipe会关闭，因此会抛出这个顾名思义的异常</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.cnblogs.com/fgokey/p/5949004.html" target="_blank" rel="external">http://www.cnblogs.com/fgokey/p/5949004.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/images/logo/icon.jpg"
               alt="小小强" />
          <p class="site-author-name" itemprop="name">小小强</p>
           
              <p class="site-description motion-element" itemprop="description">技术之路历练</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/wayd2001" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/u/5813fda87ee0" target="_blank" title="JianShu">
                  
                    <i class="fa fa-fw fa-book"></i>
                  
                  JianShu
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.jianshu.com/u/5813fda87ee0" title="小小强简书" target="_blank">小小强简书</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>

<span id="busuanzi_container_site_uv">
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>


<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小小强</span>
</div>



<div class="powered-by">
  由 <a class="theme-link" href="#">小小强</a> 个人专属
</div>

<div class="theme-info">
  博客 -
  <a class="theme-link" href="#">
   小小强
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  
    

    
  





  






  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  



</body>
</html>
